CREATE TABLE EMP2(eno number,ename varchar(10),department varchar(10),salary number);

insert into EMP2(eno,ename,department,salary) values (1,'garv','IT',100000);
insert into EMP2(eno,ename,department,salary) values (2,'dhruvi','design',80000);
insert into EMP2(eno,ename,department,salary) values (3,'dhruv','design',60000);
insert into EMP2(eno,ename,department,salary) values (4,'tirth','finance',65000);
insert into EMP2(eno,ename,department,salary) values (5,'Pooja','management',90000);


--1. Create an explicit cursor to store the employee data who is working in ‘IT’ department into department table.
DECLARE
NO EMP2.ENO%TYPE;
NAME EMP2.ENAME%TYPE;
DEPARTMENT EMP2.DEPARTMENT%TYPE;
SALARY EMP2.SALARY%TYPE;
CURSOR ANS1 IS
SELECT ENO,ENAME,DEPARTMENT,SALARY FROM EMP2;
BEGIN
OPEN ANS1;
LOOP
FETCH ANS1 INTO NO,NAME,DEPARTMENT,SALARY;
EXIT WHEN ANS1%NOTFOUND;
DBMS_OUTPUT.PUT_LINE('NO : '||NO);
DBMS_OUTPUT.PUT_LINE('NAME : '||NAME);
DBMS_OUTPUT.PUT_LINE('DEPARTMENT : '||DEPARTMENT);
DBMS_OUTPUT.PUT_LINE('SALARY : '||SALARY);
END LOOP;
CLOSE ANS1;
END;
/

--2. Create an explicit cursor to display data in sorted order salary wise in descending form.
DECLARE
NO EMP2.ENO%TYPE;
NAME EMP2.ENAME%TYPE;
DEPARTMENT EMP2.DEPARTMENT%TYPE;
SALARY EMP2.SALARY%TYPE;
CURSOR ANS2 IS
SELECT ENO,ENAME,DEPARTMENT,SALARY FROM EMP2 ORDER BY SALARY DESC;
BEGIN
OPEN ANS2;
LOOP
FETCH ANS2 INTO NO,NAME,DEPARTMENT,SALARY;
EXIT WHEN ANS2%NOTFOUND;
DBMS_OUTPUT.PUT_LINE('NO : '||NO);
DBMS_OUTPUT.PUT_LINE('NAME : '||NAME);
DBMS_OUTPUT.PUT_LINE('DEPARTMENT : '||DEPARTMENT);
DBMS_OUTPUT.PUT_LINE('SALARY : '||SALARY);
END LOOP;
CLOSE ANS2;
END;
/

--3. Create an explicit cursor to increase salary by 3% who is working in ‘finance’ department.
DECLARE
DEPARTMENT EMP2.DEPARTMENT%TYPE;
SALARY EMP2.SALARY%TYPE;
CURSOR ANS3 IS
SELECT DEPARTMENT,SALARY FROM EMP2 WHERE DEPARTMENT='finance';
BEGIN
OPEN ANS3;
LOOP
FETCH ANS3 INTO DEPARTMENT,SALARY;
EXIT WHEN ANS3%NOTFOUND;
UPDATE EMP2 VALUE SET SALARY=SALARY+((SALARY*3)/100);
END LOOP;
CLOSE ANS3;
END;
/

--4. Create an explicit cursor to delete a record who is working in ‘management’ department.
DECLARE
DEP EMP2.DEPARTMENT%TYPE;
CURSOR ANS4 IS
SELECT DEPARTMENT FROM EMP2 WHERE DEPARTMENT='management';
BEGIN
OPEN ANS4;
LOOP
FETCH ANS4 INTO DEP;
EXIT WHEN ANS4%NOTFOUND;
delete from emp2 where DEPARTMENT=DEP;
END LOOP;
CLOSE ANS4;
END;
/

--5. Write a code to create a package which will include two procedures for insert a record into a table and delete a record from the table.
CREATE or REPLACE PACKAGE ANSWER5 AS
PROCEDURE ADD(NO NUMBER,NAME VARCHAR2,DEPARTMENT VARCHAR2,SALARY NUMBER);
PROCEDURE DEL(NO EMP2.ENO%TYPE);
END ANSWER5;
/

CREATE OR REPLACE PACKAGE BODY ANSWER5 AS
PROCEDURE ADD(NO NUMBER,NAME VARCHAR2,DEPARTMENT VARCHAR2,SALARY NUMBER) 
IS
BEGIN
INSERT INTO EMP2 VALUES(NO,NAME,DEPARTMENT,SALARY);
END ADD;
PROCEDURE DEL(NO EMP2.ENO%TYPE)
IS
BEGIN
DELETE FROM EMP2 WHERE ENO=NO;
END DEL;
END ANSWER5;
/

DECLARE 
BEGIN
ANSWER5.ADD(10,'Mansi','IT',80000);
ANSWER5.ADD(11,'Lisha','design',70000);
ANSWER5.DEL(3);
END;
/

--6. Write a code to create a package which will include a procedure to update salary with 1000 rs.
CREATE OR REPLACE PACKAGE ANSWER6 AS
PROCEDURE UP_SAL(NO EMP2.ENO%TYPE);
END ANSWER6;
/

CREATE OR REPLACE PACKAGE BODY ANSWER6 AS
PROCEDURE UP_SAL(NO EMP2.ENO%TYPE)
IS
BEGIN
UPDATE EMP2 VALUE SET SALARY=SALARY+1000 WHERE ENO=NO;
END UP_SAL;
END ANSWER6;
/

BEGIN
ANSWER6.UP_SAL(2);
END;
/

--ERROR
--7. Write a code to create a package which will include two procedures for set a record into a table and getting a record from the table.
CREATE OR REPLACE PACKAGE ANSWER7 AS
  PROCEDURE ADD(NO NUMBER, NAME VARCHAR2, DEPARTMENT VARCHAR2, SALARY NUMBER);
  PROCEDURE GET(NO EMP2.ENO%TYPE, ROW OUT EMP2%ROWTYPE);
END ANSWER7;
/

CREATE OR REPLACE PACKAGE BODY ANSWER7 AS
  PROCEDURE ADD(NO NUMBER, NAME VARCHAR2, DEPARTMENT VARCHAR2, SALARY NUMBER) IS
  BEGIN
    INSERT INTO EMP2 VALUES (NO, NAME, DEPARTMENT, SALARY);
  END ADD;

  PROCEDURE GET(NO EMP2.ENO%TYPE, ROW OUT EMP2%ROWTYPE) IS
  BEGIN
    SELECT * INTO ROW FROM EMP2 WHERE ENO = NO;
  END GET;
END ANSWER7;
/

DECLARE 
  ROW EMP2%ROWTYPE;
BEGIN
  ANSWER7.ADD(12, 'isha', 'design', 37000);
  ANSWER7.GET(3, ROW);
  -- You can now use ROW for further processing or display
  DBMS_OUTPUT.PUT_LINE('Retrieved Details:');
  DBMS_OUTPUT.PUT_LINE('ENO: ' || ROW.ENO);
  DBMS_OUTPUT.PUT_LINE('ENAME: ' || ROW.ENAME);
  DBMS_OUTPUT.PUT_LINE('DEPARTMENT: ' || ROW.DEPARTMENT);
  DBMS_OUTPUT.PUT_LINE('SALARY: ' || ROW.SALARY);
END;
/
